set_up_spells = {
	# Spell Categories
	add_to_global_variable_list = { name = spell_categories_list target = flag:self }
	add_to_global_variable_list = { name = spell_categories_list target = flag:character }
	add_to_global_variable_list = { name = spell_categories_list target = flag:title }
	
	##GENERIC SPELLS##
	# Self
	add_to_global_variable_list = { name = self_spells_list target = flag:summon_sidhe_child }
	add_to_global_variable_list = { name = self_spells_list target = flag:summon_sidhe_advisor }
	add_to_global_variable_list = { name = self_spells_list target = flag:summon_sidhe_feast }
	add_to_global_variable_list = { name = self_spells_list target = flag:summon_magical_army }
	add_to_global_variable_list = { name = self_spells_list target = flag:summon_magical_siege_engine }
	add_to_global_variable_list = { name = self_spells_list target = flag:command_the_wind }
	add_to_global_variable_list = { name = self_spells_list target = flag:hidden_blade }
	add_to_global_variable_list = { name = self_spells_list target = flag:hidden_eye }
	add_to_global_variable_list = { name = self_spells_list target = flag:hidden_aura }
	add_to_global_variable_list = { name = self_spells_list target = flag:extend_lifespan }
	add_to_global_variable_list = { name = self_spells_list target = flag:channel_giant_strength }
	add_to_global_variable_list = { name = self_spells_list target = flag:exchange_your_talents }
	add_to_global_variable_list = { name = self_spells_list target = flag:sidhe_speechcraft }
	add_to_global_variable_list = { name = self_spells_list target = flag:heal_wounds }

	# Character Targets
	add_to_global_variable_list = { name = character_spells_list target = flag:inflict_wounds }
	add_to_global_variable_list = { name = character_spells_list target = flag:inflict_terror }
	add_to_global_variable_list = { name = character_spells_list target = flag:inflict_pestilence }
	add_to_global_variable_list = { name = character_spells_list target = flag:hostile_whispers }
	add_to_global_variable_list = { name = character_spells_list target = flag:captivate_mind }

	# Titles
	add_to_global_variable_list = { name = title_spells_list target = flag:bless_the_cattle }
	add_to_global_variable_list = { name = title_spells_list target = flag:multiply_herds }
	
	##CESSARIAN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:fintan_transformation }
	add_to_global_variable_list = { name = self_spells_list target = flag:deer_form }
	
	##IABHISM SPELlS##
	add_to_global_variable_list = { name = character_spells_list target = flag:flood_realm }
	add_to_global_variable_list = { name = character_spells_list target = flag:mark_of_cain }
	add_to_global_variable_list = { name = character_spells_list target = flag:serpent_bite }
	add_to_global_variable_list = { name = title_spells_list target = flag:garden_eden } 
	
	##FOMORIAN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:call_sea_armies }
	add_to_global_variable_list = { name = self_spells_list target = flag:call_underground_ridri }
	add_to_global_variable_list = { name = character_spells_list target = flag:fomorian_transformation }
	add_to_global_variable_list = { name = character_spells_list target = flag:destroy_essence }
	add_to_global_variable_list = { name = character_spells_list target = flag:blood_moon }
	add_to_global_variable_list = { name = character_spells_list target = flag:omen_of_opression }
	
	##TUATHA DE DANANN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:healing_secret }
	add_to_global_variable_list = { name = self_spells_list target = flag:silverarmed }
	add_to_global_variable_list = { name = self_spells_list target = flag:dagda_cauldron }
	add_to_global_variable_list = { name = self_spells_list target = flag:lugh_strenght }
	add_to_global_variable_list = { name = self_spells_list target = flag:call_light }
	add_to_global_variable_list = { name = self_spells_list target = flag:lost_knowledge }
	add_to_global_variable_list = { name = character_spells_list target = flag:summon_new_tribe }
	
	##MEGALITHIC ANCIENT HUMANS##
	add_to_global_variable_list = { name = self_spells_list target = flag:sacred_building }
	add_to_global_variable_list = { name = self_spells_list target = flag:suns_chosen }
	add_to_global_variable_list = { name = self_spells_list target = flag:hunting_spirits }
	
	##PARTHOLONIAN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:rune_words }
	add_to_global_variable_list = { name = self_spells_list target = flag:protective_amulet }
	add_to_global_variable_list = { name = self_spells_list target = flag:greek_astrology }
	add_to_global_variable_list = { name = character_spells_list target = flag:cursed_tablet }
	add_to_global_variable_list = { name = character_spells_list target = flag:partholonian_plague }
	
	##NEMEDIAN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:sidhe_agriculture }
	add_to_global_variable_list = { name = self_spells_list target = flag:blessed_family }
	add_to_global_variable_list = { name = self_spells_list target = flag:nemedian_union }
	add_to_global_variable_list = { name = character_spells_list target = flag:nemed_seduction }
	
	##FIR BOLG SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:srengs_strenght }
	add_to_global_variable_list = { name = self_spells_list target = flag:fir_bolg_endurance }
	add_to_global_variable_list = { name = self_spells_list target = flag:men_of_bags }
	add_to_global_variable_list = { name = self_spells_list target = flag:heavy_lifters }
	add_to_global_variable_list = { name = self_spells_list target = flag:united_in_defiance }
	
	#MILESIAN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:path_of_destiny }
	add_to_global_variable_list = { name = self_spells_list target = flag:realm_ceremony }
	add_to_global_variable_list = { name = self_spells_list target = flag:enchant_bedroooms }
	
	#HUMANS SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:druidic_intersessions }
	add_to_global_variable_list = { name = self_spells_list target = flag:magic_paintings }
	add_to_global_variable_list = { name = self_spells_list target = flag:befriend_the_morrigan }
	add_to_global_variable_list = { name = self_spells_list target = flag:settle_power }
	add_to_global_variable_list = { name = title_spells_list target = flag:influence_culture }
	
	#HY BRASILIANS SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:mystical_craft }
	add_to_global_variable_list = { name = self_spells_list target = flag:two_worlds }
	add_to_global_variable_list = { name = character_spells_list target = flag:no_escape_curse }
	add_to_global_variable_list = { name = character_spells_list target = flag:brasil_fog }
	add_to_global_variable_list = { name = character_spells_list target = flag:magic_mist }
	
	#LATIN SPELLS##
	add_to_global_variable_list = { name = self_spells_list target = flag:burn_incense }
	add_to_global_variable_list = { name = self_spells_list target = flag:roman_astrology }
	
	####List to give out new spells###
	##GENERIC SPELLS##
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:summon_sidhe_child_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:summon_sidhe_advisor_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:summon_sidhe_feast_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:summon_magical_army_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:summon_magical_siege_engine_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:command_the_wind_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:hidden_blade_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:hidden_eye_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:hidden_aura_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:extend_lifespan_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:channel_giant_strength_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:exchange_your_talents_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:sidhe_speechcraft_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:heal_wounds_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:inflict_wounds_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:inflict_terror_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:inflict_pestilence_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:hostile_whispers_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:captivate_mind_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:bless_the_cattle_known }
	add_to_global_variable_list = { name = generic_spells_global_list target = flag:multiply_herds_known }
	##CESSARIAN SPELLS##
	add_to_global_variable_list = { name = cessarian_spells_global_list target = flag:fintan_transformation_known }
	add_to_global_variable_list = { name = cessarian_spells_global_list target = flag:deer_form_known }
	##IABHISM SPELLS##
	add_to_global_variable_list = { name = iabishm_spells_global_list target = flag:flood_realm_known }
	add_to_global_variable_list = { name = iabishm_spells_global_list target = flag:mark_of_cain_known }
	add_to_global_variable_list = { name = iabishm_spells_global_list target = flag:serpent_bite_known }
	add_to_global_variable_list = { name = iabishm_spells_global_list target = flag:garden_eden_known }
	##FOMORIAN SPELLS##
	add_to_global_variable_list = { name = fomorian_spells_global_list target = flag:call_sea_armies_known }
	add_to_global_variable_list = { name = fomorian_spells_global_list target = flag:call_underground_ridri_known }
	add_to_global_variable_list = { name = fomorian_spells_global_list target = flag:fomorian_transformation_known }
	add_to_global_variable_list = { name = fomorian_spells_global_list target = flag:destroy_essence_known }
	add_to_global_variable_list = { name = fomorian_spells_global_list target = flag:blood_moon_known }
	add_to_global_variable_list = { name = fomorian_spells_global_list target = flag:omen_of_opression_known }
	##TUATHA DE DANANN SPELLS##
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:healing_secret_known }
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:silverarmed_known }
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:dagda_cauldron_known }
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:lugh_strenght_known }
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:call_light_known }
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:lost_knowledge_known }
	add_to_global_variable_list = { name = tuatha_de_danann_spells_global_list target = flag:summon_new_tribe_known }
	##MEGALITHIC ANCIENT HUMANS##
	add_to_global_variable_list = { name = megalithic_human_spells_global_list target = flag:sacred_building_known }
	add_to_global_variable_list = { name = megalithic_human_spells_global_list target = flag:suns_chosen_known }
	add_to_global_variable_list = { name = megalithic_human_spells_global_list target = flag:hunting_spirits_known }
	##PARTHOLONIAN SPELLS##
	add_to_global_variable_list = { name = partholonian_spells_global_list target = flag:rune_words_known }
	add_to_global_variable_list = { name = partholonian_spells_global_list target = flag:protective_amulet_known }
	add_to_global_variable_list = { name = partholonian_spells_global_list target = flag:greek_astrology_known }
	add_to_global_variable_list = { name = partholonian_spells_global_list target = flag:cursed_tablet_known }
	add_to_global_variable_list = { name = partholonian_spells_global_list target = flag:partholonian_plague_known }
	##NEMEDIAN SPELLS##
	add_to_global_variable_list = { name = nemedian_spells_global_list target = flag:sidhe_agriculture_known }
	add_to_global_variable_list = { name = nemedian_spells_global_list target = flag:blessed_family_known }
	add_to_global_variable_list = { name = nemedian_spells_global_list target = flag:nemedian_union_known }
	add_to_global_variable_list = { name = nemedian_spells_global_list target = flag:nemed_seduction_known }
	##FIR BOLG SPELLS##
	add_to_global_variable_list = { name = fir_bolg_spells_global_list target = flag:srengs_strenght_known }
	add_to_global_variable_list = { name = fir_bolg_spells_global_list target = flag:fir_bolg_endurance_known }
	add_to_global_variable_list = { name = fir_bolg_spells_global_list target = flag:men_of_bags_known }
	add_to_global_variable_list = { name = fir_bolg_spells_global_list target = flag:heavy_lifters_known }
	add_to_global_variable_list = { name = fir_bolg_spells_global_list target = flag:united_in_defiance_known }
	#MILESIAN SPELLS##
	add_to_global_variable_list = { name = milesian_spells_global_list target = flag:path_of_destiny_known }
	add_to_global_variable_list = { name = milesian_spells_global_list target = flag:realm_ceremony_known }
	add_to_global_variable_list = { name = milesian_spells_global_list target = flag:enchant_bedroooms_known }
	#HUMANS SPELLS##
	add_to_global_variable_list = { name = celt_spells_global_list target = flag:druidic_intersessions_known }
	add_to_global_variable_list = { name = celt_spells_global_list target = flag:magic_paintings_known }
	add_to_global_variable_list = { name = celt_spells_global_list target = flag:befriend_the_morrigan_known }
	add_to_global_variable_list = { name = celt_spells_global_list target = flag:settle_power_known }
	add_to_global_variable_list = { name = celt_spells_global_list target = flag:influence_culture_known }
	#HY BRASILIANS SPELLS##
	add_to_global_variable_list = { name = hy_brasilian_spells_global_list target = flag:mystical_craft_known }
	add_to_global_variable_list = { name = hy_brasilian_spells_global_list target = flag:two_worlds_known }
	add_to_global_variable_list = { name = hy_brasilian_spells_global_list target = flag:no_escape_curse_known }
	add_to_global_variable_list = { name = hy_brasilian_spells_global_list target = flag:brasil_fog_known }
	add_to_global_variable_list = { name = hy_brasilian_spells_global_list target = flag:magic_mist_known }
	#LATIN SPELLS##
	add_to_global_variable_list = { name = latin_spells_global_list target = flag:burn_incense_known }
	add_to_global_variable_list = { name = latin_spells_global_list target = flag:roman_astrology_known }
}

run_bad_effects_spell = {
	if = {
		limit = { failure_chance_for_spells > 15 }
		random_list = {
			100 = {
				modifier = {
					add = negative_failure_chance_for_spells
				}
				custom_description = {
					text = the_spell_is_cast_message
				}
			}
			0 = {
				modifier = {
					add = failure_chance_for_spells
				}
				set_variable = spell_fails
				custom_description = {
					text = something_bad_happens_magic
					random_list = {
						50 = {
							add_stress = 100
						}
						20 = {
							random_list = {
								50 = {
									contract_disease_effect = { DISEASE = ill TREATMENT_EVENT = yes }
								}
								30 = {
									contract_disease_effect = { DISEASE = pneumonic TREATMENT_EVENT = no }
								}
								15 = {
									contract_disease_effect = { DISEASE = leper TREATMENT_EVENT = no }
								}
								5 = {
									contract_disease_effect = { DISEASE = great_pox TREATMENT_EVENT = no }
								}
							}
						}
						20 = {
							change_variable = {
								name = your_magic_usage
								add = 1
							}
						}
						1 = {
							death = natural
						}
					}
				}
			}
		}
	}
}

gain_magician_trait = {
	random_list = {
		89 = {
			add_trait = magician_good_1
		}
		10 = {
			add_trait = magician_good_2
		}
		1 = {
			add_trait = magician_good_3
		}
	}
	set_variable = {
		name = your_magic_usage
		value = 0
	}
}

learn_a_spell_magician_effect = {
	every_in_global_list = { #put all generic spells in potential list
		variable = generic_spells_global_list
		add_to_list = potential_new_spell_list
	}
	if = { #then every specific ones
		limit = { has_trait = cessarian }
		every_in_global_list = { 
			variable = cessarian_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_faith = faith:iabhism }
		every_in_global_list = { 
			variable = iabishm_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = fomorian }
		every_in_global_list = { 
			variable = fomorian_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = tuatha_de_danann }
		every_in_global_list = { 
			variable = tuatha_de_danann_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = megalith_human }
		every_in_global_list = { 
			variable = megalithic_human_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = partholonian }
		every_in_global_list = { 
			variable = partholonian_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = nemedian }
		every_in_global_list = { 
			variable = nemedian_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = fir_bolg }
		every_in_global_list = { 
			variable = fir_bolg_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = milesian }
		every_in_global_list = { 
			variable = milesian_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = celtic_human }
		every_in_global_list = { 
			variable = celt_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = hy_brazylian }
		every_in_global_list = { 
			variable = hy_brasilian_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	if = {
		limit = { has_trait = latin_human }
		every_in_global_list = { 
			variable = latin_spells_global_list
			add_to_list = potential_new_spell_list
		}
	}
	random_in_list = {
		list = potential_new_spell_list
		limit = { 
			OR = {
				NOT = { exists = var:list_of_spells_known }
				NOT = { is_in_list = list_of_spells_known } 
			}
		}
		save_scope_as = potential_new_spell
	}
	add_to_variable_list = {
		name = list_of_spells_known
		target = scope:potential_new_spell
	}
}